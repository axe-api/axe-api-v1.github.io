import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.18efe07a.js";const m=JSON.parse('{"title":"Model.deletedAtColumn()","description":"","frontmatter":{},"headers":[],"relativePath":"reference/model-deleted-at-column.md","filePath":"reference/model-deleted-at-column.md"}'),e={name:"reference/model-deleted-at-column.md"},o=l(`<h1 id="model-deletedatcolumn" tabindex="-1">Model.<code>deletedAtColumn()</code> <a class="header-anchor" href="#model-deletedatcolumn" aria-label="Permalink to &quot;Model.\`deletedAtColumn()\`&quot;">​</a></h1><p>A soft delete marks a record as no longer active or valid without actually deleting it from the database. Soft deletes can improve performance, and can allow “deleted” data to be recovered.</p><p>You must define which table column will be used as soft-delete column to keep deletion date;</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Customer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Model</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">deletedAtColumn</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;deleted_at&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;"> Customer;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Customer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Model</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">get</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">deletedAtColumn</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;deleted_at&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> Customer;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Your database table must have <code>deleted_at</code> column. The data type must be <code>DATETIME</code> and the field should be <code>nullabe</code>.</p><p>This is a simple migration example you can use;</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">up</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">knex</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> knex.schema.</span><span style="color:#B392F0;">createTable</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;customers&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">table</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    table.</span><span style="color:#B392F0;">increments</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    table.</span><span style="color:#B392F0;">string</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;name&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    table.</span><span style="color:#B392F0;">datetime</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;deleted_at&quot;</span><span style="color:#E1E4E8;">).</span><span style="color:#B392F0;">nullable</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    table.</span><span style="color:#B392F0;">timestamps</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">up</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">knex</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> knex.schema.</span><span style="color:#6F42C1;">createTable</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;customers&quot;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">table</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    table.</span><span style="color:#6F42C1;">increments</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    table.</span><span style="color:#6F42C1;">string</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    table.</span><span style="color:#6F42C1;">datetime</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;deleted_at&quot;</span><span style="color:#24292E;">).</span><span style="color:#6F42C1;">nullable</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    table.</span><span style="color:#6F42C1;">timestamps</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  });</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div></div><p>You can use soft delete feature after this configurations.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You can use <a href="/reference/handlers-force-delete-handler.html">FORCE_DELETE</a> handler if you want to delete a record completelty.</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Soft-deleted records are not listed in the results. It is the same for related models, too.</p></div>`,8),p=[o];function t(c,r,E,y,d,i){return a(),n("div",null,p)}const F=s(e,[["render",t]]);export{m as __pageData,F as default};
